---
layout: post
date:   2010-09-09 13:15:00 +0100
author: wizillo
categories: hacking tales_of_vesperia
---

El apple gel original:

![](/img/2010/09/apple_0.jpg)

Para probar que estaba modificando el archivo que tocaba y que todo era como esperaba, he creado una imagen raw de 128x128xA8R8G8B8 de color negro (255,0,0,0) y la he plantado donde iba el appl gel. Ha ido chachi wachi:

{% highlight php %}
for ($n = 0; $n < 128 * 128; $n++) {
   list($a, $r, $g, $b) = array(0xFF, 0x00, 0x00, 0x00);
   fwrite($f, pack('C4', $a, $r, $g, $b));
}
{% endhighlight %}

![](/img/2010/09/apple_1.jpg)

Primeras pruebas de contenido 96 pixeles pintados de degradados de rojo, verde y azul:

{% highlight php %}
for ($n = 0; $n < 128 * 128; $n++) {
   list($a, $r, $g, $b) = array(0xFF, 0x00, 0x00, 0x00);
   if ($n >=  0 && $n < 32) $r = ($n - 0) * 8;
   if ($n >= 32 && $n < 64) $g = ($n - 32) * 8;
   if ($n >= 64 && $n < 96) $b = ($n - 64) * 8;
   fwrite($f, pack('C4', $a, $r, $g, $b));
}
{% endhighlight %}

![](/img/2010/09/apple_2.jpg)

Prueba de mapeado completo (cada pixel tiene un color diferente la X hace que la intensidad del rojo aumente y la Y que la intensidad del azul aumente):

{% highlight php %}
for ($y = 0; $y < 128; $y++) {
   for ($x = 0; $x < 128; $x++) {
      list($a, $r, $g, $b) = array(0xFF, 0x00, 0x00, 0x00);
      $r = $x * 2;
      $b = $y * 2;
      fwrite($f, pack('C4', $a, $r, $g, $b));
   }
}
{% endhighlight %}

![](/img/2010/09/black128x128.txv_.png)

![](/img/2010/09/apple_3.jpg)

Prueba con un degradado de arriba a abajo:

{% highlight php %}
for ($n = 0, $y = 0; $y < 128; $y++) {
   for ($x = 0; $x < 128; $x++, $n++) {
      list($a, $r, $g, $b) = array(0xFF, 0x00, 0x00, 0x00);
      $b = $g = $r = ($y / 127) * 255;
      fwrite($f, pack('C4', $a, $r, $g, $b));
      imagesetpixel($i, $x, $y, imagecolorallocate($i, $r, $g, $b));
   }
}
{% endhighlight %}

![](/img/2010/09/degradado_arriba_abajo.png)

![](/img/2010/09/apple_4.jpg)

Y luego prueba con un degradado de izquierda a derecha:

![](/img/2010/09/degradado_izquierda_derecha.png)

![](/img/2010/09/apple_5.jpg)

